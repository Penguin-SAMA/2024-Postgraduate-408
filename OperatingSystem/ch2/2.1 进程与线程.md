# 2.1 进程与线程

## 2.1.1 进程的概念和特征

#### 进程的概念

进程是计算机中一个执行的程序实例，是操作系统资源分配和调度的独立单位，是操作系统中最基础与最重要的概念之一。

进程控制块PCB：操作系统为每个进程配备的一个记录型数据结构。

由**程序段**、**数据段**和**PCB**三部分构成了进程实体(也称进程映像)。

所谓创建进程，实质上是创建进程实体中的PCB；

而撤销进程，实质上是撤销进程的PCB。

==❗注意：PCB是进程存在的唯一标志！！！==

> 进程的定义：进程是进程实体的运行过程，是系统进行资源分配和调度的一个独立单位。

#### 进程的特征

- 动态性：动态性是进程最基本的特征。
- 并发性。
- 独立性：进程实体是一个能独立运行、独立获得资源和独立接受调度的基本单位。
- 异步性。

#### 进程的其他定义

- 进程是程序的一次执行过程。
- 进程是一个程序及其数据在处理器上顺序执行时所发生的活动。
- 进程是具有独立功能的程序在一个数据集合上运行的过程，它是系统进行资源分配和调度的独立单位。
- 进程是正在计算机上执行的程序实例。
- 进程是能分配给处理器并由处理器执行的实体。
- 进程是由一组执行的指令、一个当前状态和一组相关的系统资源表征的活动单元。
- 进程由程序段、数据段、进程控制块三部分组成。

## 2.1.2 进程的状态与转换

进程通常有以下五种状态：

- 运行态：进程在处理机上运行。
- 就绪态：进程获得了除处理机外的一切所需资源，一旦得到处理机，便可立即运行。
- 阻塞态(也称等待态)：进程正在等待某一事件而暂停运行，如等待某资源为可用或等待输入/输出完成。
- 创建态(也称新建态)：进程正在被创建，尚未转到就绪态。
- 终止态(也称结束态)：进程正从系统中消失，可能是进程正常结束或其他原因退出运行。

<img src="./assets/f0e1d9a8944841502eb342f1990827c.jpg" alt="f0e1d9a8944841502eb342f1990827c" style="zoom: 33%;" />

> 区别就绪态和等待态：
>
> - 就绪态是指进程仅缺少处理器，只要获得处理机资源就立即运行。
> - 等待态是指进程需要其他资源或等待某一事件。

三种基本状态的转换：

- 就绪态->运行态：处于就绪态的进程被调度后，获得处理机资源，于是进程由就绪态转换为运行态。
- 运行态->就绪态：处于运行态的进程在时间片用完后，不得不让出处理机，从而进程由运行态转换为就绪态。
- 运行态->阻塞态：进程请求某一资源的使用和分配或等待某一事件的发生时，它就从运行态转换为就绪态。
- 阻塞态->就绪态：进程等待的事件到来时，如I/O操作结束或中断结束时，中断处理程序必须把进程由阻塞态转换为就绪态。
- <img src="./assets/image-20230320213843363.png" alt="image-20230320213843363" style="zoom: 67%;" />

> - 不能由阻塞态直接转换为运行态。
> - 不能由就绪态直接转换为阻塞态。
> - 一个进程从运行态变成阻塞态是主动行为。
> - 一个进程由阻塞态变成就绪态是被动行为。

## 2.1.3 进程组织

进程是操作系统资源分配的最小单位，在未引入线程概念的操作系统中，也是调度的最小单位。

#### 进程控制块PCB的功能概述

- 作为独立运行基本单位的标志。
- 实现进程的间断运行。
- 提供进程调度和管理所需要的信息。
- 实现与其他进程的同步与通信。

#### PCB中的内容

- 标识符：标识符是唯一标识，以数字或数字加字母的形式存储在PCB中。
  - 进程标识符PID
  - 父进程的PID
  - 用户标识符UID
- 处理器状态信息：又称处理器上下文，记录进程在执行态下关键寄存器的信息，用于进程切换后恢复处理器上的重要信息。
  - 通用寄存器
  - 程序计数器PC
  - 程序状态字PSW
  - 用户栈指针
- 处理器调度信息：该类信息的存储取决于操作系统使用何种调度方法来将处理器分配给进程。
  - 进程调度状态，记录执行态、就绪态、阻塞态等。
  - 进程调度优先级，在多个进程就绪时，用于决定那个进程先获得处理器资源。
  - 调度的相关信息，这取决于调度算法。
  - 事件，指进程由执行态转换为阻塞态的原因。
- 进程控制信息：用于进程控制所必须的信息。
  - 代码段和数据段的地址
  - 进程同步和通信机制
  - 进程特权
  - 资源清单
  - 存储管理
  - 链接指针